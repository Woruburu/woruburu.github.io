import{P as A,c as e,H as w,S as h,T as f,m as $,e as R,F as B,A as k,L as T,Q as W,R as K,b as N,U as G,V as J,d,f as b,a as S,t as _,j as F,W as V,X as q,Y as Q,Z as X,_ as Y,$ as U,a0 as Z,a1 as ee,o as te,n as M,g as re,h as ne,a2 as oe,l as ie,M as L,G as O,E as ae}from"./index.f84a5a35.js";import{C as m,L as ce}from"./Card.b4a4a919.js";import{f as le}from"./index.01df5634.js";var C={exports:{}};(function(r,n){(function(l,u){u()})(A,function(){function l(t,o){return typeof o>"u"?o={autoBom:!1}:typeof o!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\uFEFF",t],{type:t.type}):t}function u(t,o,p){var c=new XMLHttpRequest;c.open("GET",t),c.responseType="blob",c.onload=function(){a(c.response,o,p)},c.onerror=function(){console.error("could not download file")},c.send()}function v(t){var o=new XMLHttpRequest;o.open("HEAD",t,!1);try{o.send()}catch{}return 200<=o.status&&299>=o.status}function g(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(o)}}var i=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof A=="object"&&A.global===A?A:void 0,E=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=i.saveAs||(typeof window!="object"||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!E?function(t,o,p){var c=i.URL||i.webkitURL,s=document.createElement("a");o=o||t.name||"download",s.download=o,s.rel="noopener",typeof t=="string"?(s.href=t,s.origin===location.origin?g(s):v(s.href)?u(t,o,p):g(s,s.target="_blank")):(s.href=c.createObjectURL(t),setTimeout(function(){c.revokeObjectURL(s.href)},4e4),setTimeout(function(){g(s)},0))}:"msSaveOrOpenBlob"in navigator?function(t,o,p){if(o=o||t.name||"download",typeof t!="string")navigator.msSaveOrOpenBlob(l(t,p),o);else if(v(t))u(t,o,p);else{var c=document.createElement("a");c.href=t,c.target="_blank",setTimeout(function(){g(c)})}}:function(t,o,p,c){if(c=c||open("","_blank"),c&&(c.document.title=c.document.body.innerText="downloading..."),typeof t=="string")return u(t,o,p);var s=t.type==="application/octet-stream",z=/constructor/i.test(i.HTMLElement)||i.safari,D=/CriOS\/[\d]+/.test(navigator.userAgent);if((D||s&&z||E)&&typeof FileReader<"u"){var I=new FileReader;I.onloadend=function(){var x=I.result;x=D?x:x.replace(/^data:[^;]*;/,"data:attachment/file;"),c?c.location.href=x:location=x,c=null},I.readAsDataURL(t)}else{var P=i.URL||i.webkitURL,j=P.createObjectURL(t);c?c.location=j:location.href=j,c=null,setTimeout(function(){P.revokeObjectURL(j)},4e4)}});i.saveAs=a.saveAs=a,r.exports=a})})(C);const H=_("<code></code>"),se=_("<strong>not</strong>"),de=r=>{const[n,l]=F("Ready"),u=()=>{const a=r.prompt;return JSON.stringify({genMeta:{dataset:0,literotica:{author:"",category:"",tags:[],targetLength:5e3},goodReads:{author:"",pubDate:2020,tags:[],targetLength:25e3}},snippets:[],version:6,title:a.Title,content:a.PromptContent.split(/(\r\n|\n)+/).map(t=>({type:"paragraph",children:[{text:t}]})),memory:a.Memory,authorsNote:a.AuthorsNote,worldInfo:a.WorldInfos.map(t=>({rank:1,value:t.Entry,keys:t.Keys.split(",").map(o=>o.trim())})),tags:a.Tags.split(",").map(t=>t.trim())})},v=()=>{const a=r.prompt.HoloAiScenario??u(),t=new Blob([a],{type:"application/json"});C.exports.saveAs(t,`${r.prompt.Title}.holo`)},g=()=>{const a=r.prompt;return JSON.stringify({scenarioVersion:0,title:a.Title,description:a.Description??"",prompt:a.PromptContent,tags:a.Tags.split(",").map(t=>t.trim()),context:[{text:a.Memory?.trim()??"",contextConfig:{prefix:"",suffix:`
`,tokenBudget:2048,reservedTokens:0,budgetPriority:800,trimDirection:"trimBottom",insertionType:"token",insertionPosition:0}},{text:a.AuthorsNote?.trim()??"",contextConfig:{prefix:"",suffix:`
`,tokenBudget:2048,reservedTokens:2048,budgetPriority:-400,trimDirection:"trimBottom",insertionType:"newline",insertionPosition:-4}}],loreBook:{lorebookVersion:1,entries:a.WorldInfos.map(t=>({keys:t.Keys.split(",").map(o=>o.trim()),text:t.Entry,displayName:t.Keys[0]?.trim()??""}))}})},i=()=>{const a=r.prompt.NovelAiScenario??g(),t=new Blob([a],{type:"application/json"});C.exports.saveAs(t,`${r.prompt.Title}.scenario`)},E=async()=>{const a=r.prompt.NovelAiScenario??g();l("Pasting"),await navigator.clipboard.writeText(a),l("Pasted"),setTimeout(()=>{l("Ready")},2e3)};return e(Z,{mb:"$1",get children(){return e(V,{get children(){return[e(w,{level:2,get children(){return e(q,{get children(){return[e(f,{flex:1,fontWeight:"$medium",textAlign:"start",children:"Export Options"}),e(Q,{})]}})}}),e(X,{px:0,pb:0,get children(){return e(m,{get children(){return[e(w,{level:1,size:"xl",mb:"$2",children:"NAI"}),e(Y,{gap:"$3",get children(){return[e(S,{onClick:i,children:"Download .scenario"}),e(S,{get disabled(){return n()!=="Ready"},onClick:E,variant:"outline",colorScheme:"neutral",get children(){return e(h,{get when(){return n()==="Pasted"},fallback:"Copy to clipboard",children:"Copied!"})}})]}}),e(U,{thickness:"$0_5",my:"$4"}),e(w,{level:1,size:"xl",mb:"$2",children:"HoloAI"}),e(S,{onClick:v,children:"Download .holo"})]}})}})]}})}})},ue=r=>e(h,{get when(){return r.worldInfos.length>0},get children(){return e(d,{get children(){return[e(b,{marginBottom:"$2",get children(){return[e(y,{children:"World Info"}),e(S,{colorScheme:"neutral",ml:"auto",type:"button",onClick:()=>{const n=new Blob([JSON.stringify(r.worldInfos.map(l=>({entry:l.Entry,keys:l.Keys,isNotHidden:!0,publicId:ee()})))],{type:"application/json"});C.exports.saveAs(n,`${r.correlationId}-worldInfo.json`)},children:"Download AID JSON"})]}}),e(te,{columns:{"@initial":1,"@md":2,"@2xl":3},gap:"$6",get children(){return e(B,{get each(){return r.worldInfos},children:n=>e(m,{get children(){return[e(w,{level:3,size:"xl",mb:"$2",children:"Keys"}),(()=>{const l=H.cloneNode(!0);return M(l,()=>n.Keys),l})(),e(U,{thickness:"$0_5",my:"$4"}),e(w,{level:3,size:"xl",mb:"$2",children:"Entry"}),(()=>{const l=H.cloneNode(!0);return M(l,()=>n.Entry),l})()]}})})}})]}})}}),he=r=>e(h,{get when(){return r.children.length>0},get children(){return e(d,{get children(){return[e(y,{children:"Sub Scenarios"}),e(N,{direction:"column",gap:"$3",get children(){return e(B,{get each(){return r.children},children:n=>e(m,{get children(){return e(b,{get children(){return[e(k,{as:T,my:"auto",width:"100%",get href(){return`/${n.Id}`},get children(){return e(w,{level:3,size:"lg",get children(){return n.Title}})}}),e(k,{ml:"auto",as:T,get href(){return`/${n.Id}`},get children(){return e(S,{children:"View"})}})]}})}})})}})]}})}}),y=r=>e(w,{level:2,size:"xl",mb:"$1",get children(){return r.children}}),pe=r=>e(N,{direction:"column",gap:"$3",get children(){return[e(w,{level:1,size:"3xl",get children(){return r.prompt.Title}}),e(h,{get when(){return r.prompt.ParentId},get fallback(){return[e(f,{get children(){return["Published on ",$(()=>le(r.prompt.DateCreated,"yyyy/MM/dd"))]}}),e(f,{get children(){return["Tags:",e(h,{get when(){return r.prompt.Nsfw},get children(){return e(R,{textTransform:"lowercase",colorScheme:"danger",marginLeft:"$1",children:"nsfw"})}}),e(B,{get each(){return r.prompt.Tags.split(",")},children:n=>e(k,{as:T,get href(){return`/?tags=${n.trim()}`},get children(){return e(R,{textTransform:"lowercase",colorScheme:"primary",marginLeft:"$1",get children(){return n.trim()}})}})})]}})]},children:n=>e(W,{status:"info",get children(){return[e(K,{mr:"$2_5",mb:"auto"}),e(N,{direction:"column",get children(){return[e(G,{children:"You are viewing a sub scenario"}),e(J,{get children(){return e(k,{as:T,my:"auto",width:"100%",href:`/${n}`,children:"Click here to return to the parent"})}})]}})]}})}),e(de,{get prompt(){return r.prompt}}),e(h,{get when(){return r.prompt.Description},children:n=>e(d,{get children(){return[e(y,{children:"Description"}),e(m,{get children(){return e(d,{as:"code",css:{whiteSpace:"pre-line"},children:n})}})]}})}),e(h,{get when(){return r.prompt.PromptContent},children:n=>e(d,{get children(){return[e(y,{children:"Prompt"}),e(m,{get children(){return e(d,{as:"code",css:{whiteSpace:"pre-line"},children:n})}}),e(b,{get children(){return e(f,{color:"$neutral10",ml:"auto",get children(){return[$(()=>n.length)," characters"]}})}})]}})}),e(h,{get when(){return r.prompt.Memory},children:n=>e(d,{get children(){return[e(y,{children:"Memory"}),e(m,{get children(){return e(d,{as:"code",css:{whiteSpace:"pre-line"},children:n})}}),e(b,{get children(){return e(f,{color:"$neutral10",ml:"auto",get children(){return[$(()=>n.length)," characters"]}})}})]}})}),e(h,{get when(){return r.prompt.Quests},children:n=>e(d,{get children(){return[e(y,{children:"Quests"}),e(m,{get children(){return e(d,{as:"code",css:{whiteSpace:"pre-line"},children:n})}}),e(b,{get children(){return e(f,{color:"$neutral10",ml:"auto",get children(){return[$(()=>n.length)," characters"]}})}})]}})}),e(h,{get when(){return r.prompt.AuthorsNote},children:n=>e(d,{get children(){return[e(y,{children:"Authors Note"}),e(m,{get children(){return e(d,{as:"code",css:{whiteSpace:"pre-line"},children:n})}}),e(b,{get children(){return e(f,{color:"$neutral10",ml:"auto",get children(){return[$(()=>n.length)," characters"]}})}})]}})}),e(h,{get when(){return r.prompt.ScriptZip},children:n=>e(d,{get children(){return[e(y,{children:"AID Script"}),e(m,{get children(){return[e(f,{color:"$danger10",get children(){return["This file has ",se.cloneNode(!0)," been scanned for viruses, download at your own risk"]}}),e(S,{type:"button",mt:"$2",onClick:()=>{const l=new Blob([n],{type:"application/zip"});C.exports.saveAs(l,`${r.prompt.CorrelationId}-scripts.zip`)},children:"Download"})]}})]}})}),e(ue,{get worldInfos(){return r.prompt.WorldInfos},get correlationId(){return r.prompt.CorrelationId}}),e(he,{get children(){return r.prompt.Children}})]}}),ye=()=>{const r=re(ne),n=oe(),[l,u]=F({type:"Loading"});ie(()=>{(async()=>{if(r.type==="Loaded"&&n.id)try{const i=await r.service.get(n.id);u(i?{type:"Loaded",prompt:i}:{type:"NotFound"})}catch(i){u({type:"Error",error:i.toString()})}})()});const v=()=>{const i=l();return i.type==="Error"&&i},g=()=>{const i=l();return i.type==="Loaded"&&i};return e(ae,{get children(){return[e(L,{get when(){return l().type==="Loading"},get children(){return e(ce,{})}}),e(L,{get when(){return l().type==="NotFound"},get children(){return e(O,{title:"Prompt does not exist",get description(){return e(k,{as:T,href:"/",children:"Click here to go back to the main page"})}})}}),e(L,{get when(){return v()},children:i=>e(O,{title:"There was an error loading the prompt",get description(){return i.error}})}),e(L,{get when(){return g()},children:i=>e(pe,{get prompt(){return i.prompt}})})]}})};export{ye as default};
//# sourceMappingURL=index.1a260793.js.map
